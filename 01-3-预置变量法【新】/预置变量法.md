# 预置变量法

1. 描述

   所谓`预置变量法`就是对ACPI的一些变量（`Name` 类型和 `FieldUnitObj` 类型）预先赋值，达到初始化的目的。【虽然这些变量被定义时已经赋值或者初始化，但在 `Method` 调用它们之前没有改变。】

   通过第三方补丁文件（`SSDT`）在 `Scope (\)` 内对这些变量进行修正可以达到我们预期的补丁效果。

2. 示例1

   假如要禁止某设备。通常的方法是使设备的 `_STA` 返回 `Zero`。

   原文：

   ```Swift
    Method (_STA, 0, NotSerialized)
    {
        ECTP (Zero)
        If ((SDS1 == 0x07))
        {
            Return (0x0F)
        }

        Return (Zero)
    }
   ```

   可以看出，只要让 `SDS1` 不等于 `0x07` 就能 让`_STA` 返回 `Zero`。采用`预置变量法`如下：

   ```Swift
    Scope (\)
    {
        External (SDS1, FieldUnitObj)
        If (_OSI ("Darwin"))
        {
            SDS1 = 0
        }
    }
   ```

3. 示例2

   一些dell机器，睡眠期间呼吸灯“`灭`”，希望改变为`呼吸状态`。研究发现：dell机器有个工作状态管控，当工作在win8时，呼吸灯“`灭`”；当工作在win7时，呼吸灯呈`呼吸状态`。

   `注`：工作状态不同于操作系统。

   原文：

   ```Swift
   ...
   If ((ACOS == Zero))
   {
        ACOS = One
        ACSE = Zero
        ......
            If (_OSI (WIN7))
            {
                ACOS = 0x80
            }
            If (_OSI (WIN8))
            {
                ACOS = 0x80
                ACSE = One
            }
        ......
   }
   ```

   按照`预置变量法`，制作补丁文件：SSDT-LedFlash-dell：

   ```Swift
   External (_SB.ACOS, IntObj)
   External (_SB.ACSE, IntObj)
   Scope (\)
   {
      If (_OSI ("Darwin"))
      {
         \_SB.ACOS = 0x80
         \_SB.ACSE = Zero
      }
   }
   ```

4. 示例3

   官方补丁：***SSDT-AWAC***，作用是强制开启 RTC。适用于部分 300 系机器。

   ```Swift
   External (STAS, IntObj)
   Scope (_SB)
   {
      Method (_INI, 0, NotSerialized)
      {
         If (_OSI ("Darwin"))
         {
            STAS = One
         }
      }
   }
   ```
